# 集团版开发

## 初始化

对项目版smart-qw仓库移植后，需要如下改动

+ 所有项目版相关关键字如`smart-qw`，`smartQw`，`企微管理后台`替换为`smart-group-qw`，`smart-group-qw`，`smartGroupQw`，`企微集团版管理后台`
+ 修改配置`ds-conf`，`ngnix-conf`等文件夹下文件适配Rscode平台

## 产品权限开通&集团项目创建

> http://smart-case-admin.focus-test.cn/manage/projectManage

+ 智慧案场超管后台登陆权限开通
+ 集团管理创建集团
+ 集团增加项目以及超管权限
+ 新增开通单开通子产品

## 权限梳理

**集团版：**目前开放集团超管登陆

集团版关联下属所有项目查看筛选权、删除、修改、创建权限

项目版可以查看集团创建项，但限制集团的编辑、删除、修改权限

## 案场基座路由配置

> https://configuration-platform.focus.cn/#/detail/62afdc13bb7ac8858b2fcdb5

集团版的基座路由需要单独配置生成

⚠️目前线上只开放员工管理



## 案场基座接入

原有微前端接入逻辑是通过案场后端返回的接口中读取drawingKey和secondryDomin进行自产品的开通权限判断和路由跳转。而项目版开发商后台用的是同一个字段，改了的话开发商后台也得改

**解决方案：**通过extInfo字段存储集团版相关信息

目前smart-group基座项目的权限和路由判定通过extInfo字段

![image-20221124155909172](/Users/xufei/Library/Application Support/typora-user-images/image-20221124155909172.png)

## 主要工作

+ ##### 极联员工筛选器

  筛选集团下多个员工的数据，**涉及到绝大多数表格选择员工**，需要一个个去联调适配

+ ##### 树桩员工筛选器

  筛选集团下多个员工的数据，**涉及到所有编辑、新建、修改页选择员工**，需要一个个去联调适配

+ ##### 表格编辑删除权限

  集团版开放最高权限，项目版不能对集团任务操作，**涉及到绝大多数表格，项目版和集团版同时修改**

**解决方案：**先等后端组完成接口检查适配集团版，对已有接口字段不作调整。后续新增接口对通用类员工筛选字段统一为departmentId和realtorId。

## 离线项目上线

smart-group-qw离线项目首次上线前需要与运维对接，部署正式环境



